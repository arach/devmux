{
  "project": "devmux",
  "version": "0.1.0",
  "generatedAt": "2026-02-21T17:45:17.816Z",
  "sections": [
    {
      "id": "concepts",
      "title": "Concepts",
      "content": "# Concepts\n\n## What is devmux?\n\ndevmux is a developer workspace launcher. It creates pre-configured\nterminal layouts for your projects using tmux, so you can go from\n\"I want to work on X\" to a full development environment in one click.\n\nIt has two parts:\n\n1. **CLI** (`devmux`) — creates and manages tmux sessions from the terminal\n2. **Menu bar app** — a native macOS companion for launching, tiling,\n   and navigating sessions with a command palette\n\n## Glossary\n\n### Session\nA tmux session is a persistent workspace that lives in the background.\nIt survives terminal crashes, disconnects, and even closing your laptop.\nThink of it as a virtual desktop for a single project.\n\n### Pane\nA pane is a single terminal view inside a session. A typical devmux\nsetup has two panes side by side — one running Claude Code and one\nrunning your dev server. You can have up to four or more.\n\n### Attach / Detach\nAttaching connects your terminal window to an existing session.\nDetaching disconnects your terminal but keeps the session alive.\nYour dev server keeps running, Claude keeps thinking — nothing is lost.\n\n### tmux\ntmux (terminal multiplexer) is the engine behind devmux. It manages\nsessions, panes, and layouts. devmux configures tmux for you so you\ndon't need to learn tmux commands — but knowing a few shortcuts helps.\n\n### Multiplexer\nA program that lets you run multiple terminal sessions inside a single\nwindow and switch between them. tmux is the most popular one.\n\n### Sync / Reconcile\nSync (`devmux sync`) brings a running session back in line with its\ndeclared config. It recreates missing panes, re-applies the layout,\nrestores labels, and re-runs commands in idle panes. Useful when a pane\nwas accidentally killed but you don't want to restart the whole session.\n\n### Ensure / Prefill\nTwo modes for restoring exited commands when you reattach to a session:\n\n- **Ensure** — automatically re-runs the command (hands-free recovery)\n- **Prefill** — types the command into the pane but waits for you to\n  press Enter (manual confirmation)\n\nSet via `\"ensure\": true` or `\"prefill\": true` in `.devmux.json`.\n\n### Command Palette\nThe menu bar app's primary interface, opened with **Cmd+Shift+M**.\nA searchable list of actions: launch/attach projects, tile windows,\nsync sessions, restart panes, open settings.\n\n### Window Tiling\nBoth the CLI (`devmux tile`) and the menu bar app can snap terminal\nwindows to preset screen positions (halves, quarters, maximize, center).\nTiling uses AppleScript bounds and respects the menu bar and dock.\n\n## How it works\n\n1. You create a `.devmux.json` file in your project root (or run `devmux init`)\n2. devmux reads the config and creates a tmux session with your layout\n3. Each pane gets its command (claude, dev server, tests, etc.)\n4. The session persists in the background until you kill it\n5. You can attach/detach from any terminal at any time\n6. If `ensure` is enabled, exited commands auto-restart on reattach\n\n## Architecture\n\n### Three-layer stack\n\n```\n┌─────────────────────────────┐\n│  Menu bar app (Swift/AppKit)│  ← GUI: command palette, tiling, project list\n├─────────────────────────────┤\n│  CLI (Node.js)              │  ← devmux, devmux sync, devmux restart ...\n├─────────────────────────────┤\n│  tmux                       │  ← session/pane lifecycle, layout, persistence\n└─────────────────────────────┘\n```\n\n- The **CLI** talks to tmux directly via `tmux` shell commands.\n- The **menu bar app** calls the CLI binary for session operations\n  (launch, sync, restart) and uses tmux directly for status checks\n  (has-session, list-panes).\n- Both layers share the same session naming convention so they always\n  agree on which session belongs to which project.\n\n### Session naming\n\nA session name is `<basename>-<hash>`, where:\n\n- `basename` is the project directory name (non-alphanumeric chars replaced with `-`)\n- `hash` is the first 6 hex chars of the SHA-256 of the full absolute path\n\nThis guarantees unique session names even if two projects share the\nsame directory name (e.g. `~/work/app` and `~/personal/app`).\n\nBoth the CLI (Node.js `crypto.createHash`) and the app (Swift\n`CryptoKit.SHA256`) produce identical hashes.\n\n### Window discovery via title tags\n\nWhen devmux creates a session, it sets the tmux option:\n\n```\nset-titles-string \"[devmux:<session-name>] #{pane_title}\"\n```\n\nThis embeds a `[devmux:name]` tag in the terminal window title. The\nmenu bar app uses this tag to find windows via three fallback paths:\n\n1. **CGWindowList** (needs Screen Recording permission) — fastest,\n   reads window names from the window server\n2. **Accessibility API** (needs Accessibility permission) — queries\n   AXUIElement window titles for the terminal app\n3. **AppleScript** — iterates Terminal.app or iTerm2 windows by name\n\n### Space switching via SkyLight\n\nThe menu bar app can switch macOS Spaces to reach a session's window.\nIt uses private SkyLight framework APIs loaded at runtime via `dlopen`:\n\n- `CGSMainConnectionID` — get the connection to the window server\n- `CGSGetActiveSpace` — current Space ID\n- `CGSCopyManagedDisplaySpaces` — enumerate all Spaces per display\n- `SLSCopySpacesForWindows` — find which Space a window is on\n- `SLSManagedDisplaySetCurrentSpace` — switch a display to a Space\n\nThis is the same approach used by [Loop](https://github.com/MrKai77/Loop)\nand other macOS window managers.\n\n### Ensure/prefill restoration\n\nWhen you run `devmux` (no arguments) and a session already exists:\n\n1. devmux checks the `ensure` / `prefill` flag in `.devmux.json`\n2. For each pane, it queries `#{pane_current_command}` via tmux\n3. If the pane is running a shell (bash, zsh, fish, sh, dash) — meaning\n   the original command has exited — it either:\n   - **ensure**: sends the command + Enter (auto-restart)\n   - **prefill**: sends the command without Enter (manual restart)\n4. Then it attaches to the session as normal\n\n## Key shortcuts (inside tmux)\n\nThese work when you're inside a tmux session:\n\n| Shortcut       | Action                |\n|----------------|-----------------------|\n| Ctrl+B  D      | Detach from session   |\n| Ctrl+B  X      | Kill current pane     |\n| Ctrl+B  Left   | Move to left pane     |\n| Ctrl+B  Right  | Move to right pane    |\n| Ctrl+B  Up     | Move to pane above    |\n| Ctrl+B  Down   | Move to pane below    |\n| Ctrl+B  Z      | Zoom pane (toggle)    |\n| Ctrl+B  [      | Scroll mode (q exits) |\n\nThe prefix `Ctrl+B` means: hold Control, press B, release both,\nthen press the next key."
    },
    {
      "id": "config",
      "title": "Config",
      "content": "# Configuration\n\n## .devmux.json\n\nPlace a `.devmux.json` file in your project root to define your\nworkspace layout. devmux reads this file when creating a session.\n\n### Minimal example\n\n```json\n{\n  \"panes\": [\n    { \"name\": \"claude\", \"cmd\": \"claude\" },\n    { \"name\": \"server\", \"cmd\": \"pnpm dev\" }\n  ]\n}\n```\n\n### Full example\n\n```json\n{\n  \"ensure\": true,\n  \"panes\": [\n    { \"name\": \"claude\", \"cmd\": \"claude\", \"size\": 60 },\n    { \"name\": \"server\", \"cmd\": \"pnpm dev\" },\n    { \"name\": \"tests\",  \"cmd\": \"pnpm test --watch\" }\n  ]\n}\n```\n\n## Config fields\n\n| Field    | Type    | Required | Description                                          |\n|----------|---------|----------|------------------------------------------------------|\n| panes    | array   | no       | List of pane definitions (see below)                 |\n| ensure   | boolean | no       | Auto-restart exited commands on reattach              |\n| prefill  | boolean | no       | Type exited commands into idle panes on reattach (you hit Enter) |\n\n`ensure` and `prefill` are mutually exclusive. If both are set,\n`ensure` takes priority.\n\n- **ensure** — when you reattach to an existing session, devmux checks\n  each pane. If a pane's process has exited and the shell is idle, devmux\n  automatically re-runs its declared command.\n- **prefill** — same check, but the command is typed into the pane\n  without pressing Enter. You review and hit Enter yourself.\n\n## Pane fields\n\n| Field  | Type   | Required | Description                         |\n|--------|--------|----------|-------------------------------------|\n| name   | string | no       | Label for the pane (shown in app)   |\n| cmd    | string | no       | Command to run when pane opens      |\n| size   | number | no       | Width % for the first pane (1-99)   |\n\n- `size` only applies to the **first pane**. It sets the width of the\n  main pane as a percentage. Default is 60.\n- `cmd` can be any shell command. If omitted, the pane opens a shell.\n- `name` is used in the devmux app to show a summary of your layout,\n  and as a target for `devmux restart <name>`.\n\n## Layouts\n\ndevmux picks a layout based on how many panes you define:\n\n### 2 panes — side by side\n\n```\n┌──────────┬─────────┐\n│  claude  │ server  │\n│  (60%)   │ (40%)   │\n└──────────┴─────────┘\n```\n\nHorizontal split. First pane on the left, second on the right.\n\n### 3+ panes — main-vertical\n\n```\n┌──────────┬─────────┐\n│  claude  │ server  │\n│  (60%)   ├─────────┤\n│          │ tests   │\n└──────────┴─────────┘\n```\n\nFirst pane takes the left side. Remaining panes stack vertically\non the right.\n\n### 4 panes\n\n```\n┌──────────┬─────────┐\n│  claude  │ server  │\n│  (60%)   ├─────────┤\n│          │ tests   │\n│          ├─────────┤\n│          │ logs    │\n└──────────┴─────────┘\n```\n\n## Auto-detection (no config)\n\nIf there's no `.devmux.json`, devmux still works. It will:\n\n1. Create a 2-pane layout (60/40 split)\n2. Run `claude` in the left pane\n3. Auto-detect your dev command from package.json scripts:\n   - Looks for: `dev`, `start`, `serve`, `watch` (in that order)\n   - Detects package manager: pnpm > bun > yarn > npm\n\n## Creating a config\n\nRun `devmux init` in your project directory to generate a starter\n`.devmux.json` based on your project. The generated config includes\n`\"ensure\": true` by default.\n\n## CLI commands\n\n| Command                    | Description                                      |\n|----------------------------|--------------------------------------------------|\n| `devmux`                   | Create or attach to session for current project   |\n| `devmux init`              | Generate .devmux.json config for this project     |\n| `devmux ls`                | List active tmux sessions                         |\n| `devmux kill [name]`       | Kill a session (defaults to current project)      |\n| `devmux sync`              | Reconcile session to match declared config        |\n| `devmux restart [pane]`    | Restart a pane's process (by name or index)       |\n| `devmux tile <position>`   | Tile the frontmost window to a screen position    |\n| `devmux app`               | Launch the menu bar companion app                 |\n| `devmux app build`         | Rebuild the menu bar app from source              |\n| `devmux app restart`       | Rebuild and relaunch the menu bar app             |\n| `devmux app quit`          | Stop the menu bar app                             |\n| `devmux help`              | Show help                                         |\n\nAliases: `ls`/`list`, `kill`/`rm`, `sync`/`reconcile`,\n`restart`/`respawn`, `tile`/`t`.\n\n## Recovery\n\n### sync\n\n```\ndevmux sync\n```\n\nReconciles a running session to match the declared config:\n\n1. Counts actual panes vs declared panes\n2. Recreates any missing panes\n3. Re-applies the layout (main-vertical with correct width)\n4. Restores pane labels\n5. Re-runs declared commands in any idle panes\n\nUse when a pane was killed and you want to get back to the declared\nstate without killing the whole session.\n\n### restart\n\n```\ndevmux restart [target]\n```\n\nKills the process in a specific pane and re-runs its declared command.\nThe target can be:\n\n- A **pane name** (case-insensitive): `devmux restart server`\n- A **0-based index**: `devmux restart 1`\n- **Omitted** (defaults to pane 0): `devmux restart`\n\nThe restart sequence: send Ctrl-C, wait 0.5s, check if the process\nstopped. If it's still running, escalate to SIGKILL on child\nprocesses. Then send the declared command.\n\n## Tile positions\n\nThe `devmux tile` command moves the frontmost window to a preset\nscreen position. Available positions:\n\n| Position       | Area                        |\n|----------------|-----------------------------|\n| `left`         | Left half                   |\n| `right`        | Right half                  |\n| `top`          | Top half                    |\n| `bottom`       | Bottom half                 |\n| `top-left`     | Top-left quarter            |\n| `top-right`    | Top-right quarter           |\n| `bottom-left`  | Bottom-left quarter         |\n| `bottom-right` | Bottom-right quarter        |\n| `maximize`     | Full screen (visible area)  |\n| `center`       | 70% width, 80% height, centered |\n\nAliases: `left-half`/`left`, `right-half`/`right`, `top-half`/`top`,\n`bottom-half`/`bottom`, `max`/`maximize`.\n\nTiling respects the menu bar and dock — it uses the visible desktop\narea, not the full screen."
    },
    {
      "id": "app",
      "title": "App",
      "content": "# Menu Bar App\n\nThe devmux menu bar app is a native macOS companion that lives in your\nmenu bar and gives you quick access to all your devmux sessions.\n\n## Installation\n\n```bash\ndevmux app          # Build (or download) and launch\ndevmux app build    # Rebuild from source\ndevmux app restart  # Quit, rebuild, relaunch\ndevmux app quit     # Stop the app\n```\n\nThe first run builds from source if Swift is available, otherwise\ndownloads a pre-built binary from GitHub releases.\n\n## Command palette\n\nPress **Cmd+Shift+M** from anywhere to open the command palette.\nIt's a searchable list of every action the app can perform, with\nfuzzy matching on titles and subtitles.\n\n### Project commands\n\n| Command                       | Description                              |\n|-------------------------------|------------------------------------------|\n| Launch *project*              | Create a new session and open terminal   |\n| Attach *project*              | Focus or open the running session        |\n| Sync *project*                | Reconcile session to declared config     |\n| Restart *pane* in *project*   | Kill and re-run a specific pane's command |\n\n### Window commands\n\nAvailable for running sessions:\n\n| Command                       | Description                              |\n|-------------------------------|------------------------------------------|\n| Go to *project*               | Focus the terminal window (switches Spaces if needed) |\n| Tile *project* Left           | Snap window to left half                 |\n| Tile *project* Right          | Snap window to right half                |\n| Maximize *project*            | Expand window to fill screen             |\n| Detach *project*              | Disconnect clients, keep session alive   |\n| Kill *project*                | Terminate the tmux session               |\n\n### App commands\n\n| Command           | Description                              |\n|-------------------|------------------------------------------|\n| Settings          | Open preferences (terminal, scan root)   |\n| Diagnostics       | View logs and debug info                 |\n| Refresh Projects  | Re-scan for .devmux.json configs         |\n| Quit Devmux       | Exit the menu bar app                    |\n\n## Project discovery\n\nThe app scans a configurable root directory (up to 3 levels deep)\nfor `.devmux.json` files. It skips `.git/` and `node_modules/`.\n\nAuto-detection for the scan root checks these paths in order:\n`~/dev`, `~/Developer`, `~/projects`, `~/src`.\n\nFor each project found, the app reads:\n- Pane names and commands from `.devmux.json`\n- Dev command and package manager from `package.json`\n- Running status by checking `tmux has-session`\n\n## Session management\n\nThe app calls the devmux CLI for session operations:\n\n- **Launch** — runs `devmux` in the project directory, which creates\n  or reattaches to the session\n- **Sync** — runs `devmux sync` to reconcile panes to the config\n- **Restart** — runs `devmux restart <pane>` to kill and re-run a\n  specific pane's process\n- **Detach** — calls `tmux detach-client` directly\n- **Kill** — calls `tmux kill-session` directly\n\n## Window tiling\n\nThe app can tile terminal windows to preset screen positions via\nthe command palette. It finds windows by their `[devmux:session-name]`\ntitle tag.\n\nFor Terminal.app and iTerm2, tiling uses AppleScript to set window\nbounds by matching the title tag. For other terminals, it tiles the\nfrontmost window.\n\n### Tile positions (app)\n\n| Position     | Area                            |\n|--------------|---------------------------------|\n| Left         | Left half                       |\n| Right        | Right half                      |\n| Top Left     | Top-left quarter                |\n| Top Right    | Top-right quarter               |\n| Bottom Left  | Bottom-left quarter             |\n| Bottom Right | Bottom-right quarter            |\n| Maximize     | Full visible screen             |\n| Center       | 70% width, 80% height, centered |\n\n## Space navigation\n\n\"Go to\" commands can switch macOS Spaces to reach a window on a\ndifferent desktop. The app uses a three-path fallback:\n\n1. **CGWindowList** (needs Screen Recording) — looks up the window\n   by title tag, finds its Space via SkyLight, switches to it, then\n   raises the window\n2. **Accessibility API** (needs Accessibility) — finds the window\n   via AXUIElement, raises it, and activates the app\n3. **AppleScript** — iterates windows by name for Terminal/iTerm2,\n   or bare-activates for other terminals\n\nWhen a window is found and focused, the app flashes a green border\nhighlight around it for ~1 second so you can spot it immediately.\n\nGrant Screen Recording and Accessibility permissions in System\nSettings > Privacy & Security for the best experience.\n\n## Settings\n\nOpen via the command palette or the gear icon in the main view.\nThe settings window has three tabs:\n\n### General\n\n| Setting    | Description                                          |\n|------------|------------------------------------------------------|\n| Terminal   | Which terminal to use (auto-detected from installed) |\n| Mode       | `learning` or `auto` (see below)                     |\n| Scan Root  | Directory to scan for .devmux.json configs (type a path or click Browse) |\n\n**Mode** controls how the app handles session interaction:\n\n- **Learning** — shows tmux keybinding hints when you detach\n  (helpful while getting used to tmux)\n- **Auto** — detaches sessions automatically (fewer prompts)\n\n### Shortcuts\n\nShows keyboard shortcut reference:\n\n| Shortcut          | Action              |\n|-------------------|----------------------|\n| Cmd+Shift+M       | Open command palette |\n| Ctrl+B  D         | Detach from session  |\n| Ctrl+B  X         | Kill current pane    |\n| Ctrl+B  Left/Right| Move between panes   |\n| Ctrl+B  Z         | Zoom pane (toggle)   |\n| Ctrl+B  [         | Scroll mode          |\n\n### Docs\n\nEmbedded quick reference with glossary, \"how it works\" steps, and\nlinks to open the full `config.md` and `concepts.md` docs.\n\n## Supported terminals\n\n| Terminal     | Launch | Focus/Attach | Tile by tag |\n|--------------|--------|--------------|-------------|\n| Terminal.app | yes    | yes          | yes         |\n| iTerm2       | yes    | yes          | yes         |\n| Warp         | yes    | activate     | frontmost   |\n| Ghostty      | yes    | activate     | frontmost   |\n| Kitty        | yes    | activate     | frontmost   |\n| Alacritty    | yes    | activate     | frontmost   |\n\n\"yes\" means full AppleScript-based window matching by title tag.\n\"activate\" means the app is brought to front but a specific window\ncan't be targeted. \"frontmost\" means tiling applies to whatever\nwindow is in front.\n\n## Diagnostics\n\nThe diagnostics panel shows a timestamped log of window navigation\nattempts, including which path succeeded or failed. Useful for\ndebugging Screen Recording / Accessibility permission issues."
    }
  ]
}